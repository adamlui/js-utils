let fs=require("fs"),path=require("path"),uglifyJS=require("uglify-js");function findJS(r,n={}){var e="https://docs.minify-js.org/node.js/#findjssearchdir-options",i={recursive:!0,verbose:!0,dotFolders:!1,dotFiles:!1,ignoreFiles:[]};if("string"!=typeof r)console.error("findJS() » ERROR: 1st arg <searchDir> must be a string."),console.info("findJS() » For more help, please visit "+e);else{var o=path.resolve(process.cwd(),r);if(fs.existsSync(o)){if(validateOptions(n,i,e,"findJS('assets/js', { verbose: false, dotFoldes: true })")){n={...i,...n};let e=fs.readdirSync(r),o=[];return n.verbose&&!n.isRecursing&&console.info("findJS() » Searching for unminified JS files..."),e.forEach(e=>{var i=path.resolve(r,e);fs.statSync(i).isDirectory()&&"node_modules"!=e&&n.recursive&&(n.dotFolders||!e.startsWith("."))?o.push(...findJS(i,{...n,isRecursing:!0})):!/\.js(?<!\.min\.js)$/.test(e)||!n.dotFiles&&e.startsWith(".")||n.ignoreFiles.includes(e)?n.verbose&&n.ignoreFiles.includes(e)&&console.info(`findJS() » ** ${e} ignored due to [options.ignoreFiles]`):o.push(i)}),n.verbose&&!n.isRecursing&&(console.info("findJS() » Search complete! "+(0==o.length?"No":o.length)+` file${1==o.length?"":"s"} found.`),"minify"!=findJS.caller?.name)&&"undefined"!=typeof window&&console.info("findJS() » Check returned array."),n.isRecursing||o.length?o:[]}}else console.error("findJS() » ERROR: 1st arg <searchDir> must be an existing directory."),console.error(`findJS() » ${o} does not exist.`),console.info("findJS() » For more help, please visit "+e)}}function minify(n,s={}){var e="https://docs.minify-js.org/node.js/#minifyinput-options",i={recursive:!0,verbose:!0,dotFolders:!1,dotFiles:!1,mangle:!0,rewriteImports:!0,cloneFolders:!1,ignoreFiles:[],comment:""};if("string"!=typeof n)console.error("minify() » ERROR: 1st arg <input> must be a string."),console.info("minify() » For more help, please visit "+e);else if(validateOptions(s,i,e,"minify('assets/js', { recursive: false, mangle: false })")){let r={mangle:!!(s={...i,...s}).mangle&&{toplevel:!1}};if(fs.existsSync(n)){if(n.endsWith(".js"))return s.verbose&&console.info(`minify() » ** Minifying ${n}...`),e=uglifyJS.minify(fs.readFileSync(n,"utf8"),r),s.comment&&(e.code=t(e.code,s.comment)),e.error?console.error("minify() » ERROR: "+e.error.message):s.verbose&&"undefined"!=typeof window&&console.info("minify() » Minification complete! Check returned object."),{code:e.code,srcPath:path.resolve(process.cwd(),n),error:e.error};i=findJS(n,{recursive:s.recursive,verbose:s.verbose,dotFolders:s.dotFolders,dotFiles:s.dotFiles,ignoreFiles:s.ignoreFiles})?.map(e=>{s.verbose&&console.info(`minify() » ** Minifying ${e}...`);var i=fs.readFileSync(e,"utf8"),i=uglifyJS.minify(i,r);let o;return s.comment&&(i.code=t(i.code,s.comment)),i.error&&console.error("minify() » ERROR: "+i.error.message),s.cloneFolders&&(o=path.relative(path.resolve(process.cwd(),n),e)),{code:i.code,srcPath:e,relPath:o,error:i.error}}).filter(e=>!e.error);if(s.verbose&&(i.length&&"undefined"!=typeof window?console.info("minify() » Minification complete! Check returned object."):console.info("minify() » No unminified JavaScript files processed.")),s.rewriteImports&&i&&1<i.length){s.verbose&&console.info("minify() » ** Rewriting import paths...");let e=i.map(e=>path.basename(e.srcPath,".js"));i.forEach(r=>e.forEach(e=>{var i=new RegExp(`(\\./?)?\\b${e}\\.js(['"])`,"g"),o=r.code;r.code=r.code.replace(i,`$1${e}.min.js$2`),o!=r.code&&s.verbose&&console.info(`minify() » Updated ${e}.js in `+path.basename(r.srcPath))})),s.verbose&&console.info("minify() » Import paths rewritten.")}return i}return s.verbose&&!process.argv.some(e=>e.includes("gulp"))&&console.info("minify() » ** Minifying passed source code..."),e=uglifyJS.minify(n,r),s.comment&&(e.code=t(e.code,s.comment)),e.error?console.error("minify() » ERROR: "+e.error.message):s.verbose&&!process.argv.some(e=>e.includes("gulp"))&&console.info("minify() » Minification complete! Check returned object."),{code:e.code,srcPath:void 0,error:e.error};function t(e,i){var i=i.split("\n").map(e=>" * "+e).join("\n"),o=e.indexOf("#!");return 0<=o?(o=e.indexOf("\n",o)+1,e.slice(0,o)+`/**
/**
 *  © 2023–2025 Adam Lui & contributors under the MIT license.
 *  Source: https://code.minify-js.org/node.js
 *  Documentation: https://docs.minify-js.org/node.js
 */
${i}
 */
`+e.slice(o)):`/**
${i}
 */
`+e}}}function validateOptions(e,i,o,r){let n=JSON.stringify(i,void 0,2).replace(/"([^"]+)":/g,"$1:").replace(/"/g,"'").replace(/\n\s*/g," "),s=Object.keys(i).join(", "),t=Object.keys(i).filter(e=>"boolean"==typeof i[e]),l=Object.keys(i).filter(e=>Number.isInteger(i[e])),c=Object.keys(i).filter(e=>Array.isArray(i[e])),f=`${validateOptions.caller?.name||"validateOptions"}() » `;var a,d=r.split(",").findIndex(e=>e.trim().startsWith("{"))+1,m=(d+=["st","nd","rd"][d-1]||"th",()=>{console.info(f+`Valid options: [ ${s} ]`),console.info(f+"If omitted, default settings are: "+n)}),p=()=>{console.info(f+"For more help, please visit "+o)};if("object"!=typeof e)return console.error(f+`ERROR: ${"0th"==d?"[O":d+" arg [o"}ptions] can only be an object of key/values.`),console.info(f+"Example valid call: "+r),m(),p(),!1;for(a in e){if("isRecursing"!=a&&!Object.prototype.hasOwnProperty.call(i,a))return console.error(f+`ERROR: \`${a}\` is an invalid option.`),m(),p(),!1;if(t.includes(a)&&"boolean"!=typeof e[a])return console.error(f+`ERROR: [${a}] option can only be \`true\` or \`false\`.`),p(),!1;if(l.includes(a)){if(e[a]=parseInt(e[a],10),isNaN(e[a])||e[a]<1)return console.error(f+`ERROR: [${a}] option can only be an integer > 0.`),p(),!1}else if(c.includes(a))if("string"!=typeof e[a]||e[a].includes(",")){if(!Array.isArray(e[a]))return console.error(f+`ERROR: [${a}] option can only be an array.`),p(),!1}else e[a]=[e[a]]}return!0}let mjsAliases={minify:["build","Build","compile","Compile","compress","Compress","Minify"],findJS:["find","Find","findjs","findJs","Findjs","FindJs","FindJS","search","Search"]};module.exports={minify:minify,findJS:findJS};for(let i in mjsAliases)mjsAliases[i].forEach(e=>module.exports[e]=module.exports[i]);