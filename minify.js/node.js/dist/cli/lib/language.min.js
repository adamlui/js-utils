/**
 * © 2024–2026 Adam Lui & contributors under the MIT license.
 * Source: https://github.com/adamlui/minify.js/tree/main/node.js/src
 * Documentation: https://github.com/adamlui/minify.js/tree/main/node.js/docs
 */
module.exports={generateRandomLang({includes:e=[],excludes:r=[]}={}){let n=require("fs"),s=require(`./log${env.devMode?"":".min"}.js`),t=require("path"),a=e.length?e:(()=>{var e=t.join(__dirname,"..",".cache"),r=t.join(e,"locales.json");if(n.existsSync(r))try{return JSON.parse(n.readFileSync(r,"utf8"))}catch(e){}var s,a=t.resolve(process.cwd(),"_locales");return n.existsSync(a)?(a=n.readdirSync(a,{withFileTypes:!0}).filter(e=>e.isDirectory()).map(e=>e.name).filter(e=>/^[a-z]{2}(?:_[A-Z]{2})?$/.test(e)),s=r+".tmp",n.mkdirSync(e,{recursive:!0}),n.writeFileSync(s,JSON.stringify(a,null,2)),n.renameSync(s,r),a):["en"]})(),l=new Set(r),i="en";return(a=a.filter(e=>!l.has(e))).length&&(i=a[Math.floor(Math.random()*a.length)]),s.debug(`
Random language:  ${i}
`),i},async getMsgs(a="en"){var e=require(`./data${env.devMode?"":".min"}.js`);let n=e.flatten(require(`../../${env.devMode?"../../_locales/en/":"data/"}messages.json`),{key:"message"});if(!a.startsWith("en")){var t=`${app.urls.jsdelivr}@${app.commitHashes.locales}/_locales/`;let r=t+a.replace("-","_")+"/messages.json",s=0;for(;s<3;)try{n=e.flatten(await(await e.fetch(r)).json(),{key:"message"});break}catch(e){if(2<++s)break;r=a.includes("-")&&1==s?r.replace(/([^_]*)_[^/]*(\/.*)/,"$1$2"):t+"en/messages.json"}}return n},getSysLang(){var e;if("win32"!=process.platform)return((e=process.env).LANG||e.LANGUAGE||e.LC_ALL||e.LC_MESSAGES||e.LC_NAME||"en").split(".")[0];try{return require("child_process").execSync("(Get-Culture).TwoLetterISOLanguageName",{shell:"powershell",encoding:"utf-8"}).trim()}catch(e){return console.error("ERROR loading system language:",e.message),"en"}}};