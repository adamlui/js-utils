/**
 * © 2024–2026 Adam Lui & contributors under the MIT license.
 * Source: https://github.com/adamlui/minify.js/tree/main/node.js/src
 * Documentation: https://github.com/adamlui/minify.js/tree/main/node.js/docs
 */
let log=require("./log"+env.modExt);module.exports={js({srcFiles:e,inputPath:i,inputArg:r,outputArg:s}){let t=require("fs"),o=require("../../minify"+env.modExt).minify,g=require("path"),n=[],l=[];var c;!cli.config.relativeOutput&&t.statSync(i).isDirectory()?(c=o(i,{verbose:!1,mangle:!cli.config.noMangle,comment:cli.config.comment?.replace(/\\n/g,"\n"),relativeOutput:!1,recursive:!cli.config.noRecursion,dotFolders:cli.config.includeDotFolders,dotFiles:cli.config.includeDotFiles,rewriteImports:cli.config.rewriteImports,ignores:cli.config.ignores?cli.config.ignores.split(",").map(e=>e.trim()):[]}))&&(c.error?n.push(i):l=[].concat(c)):l=e.map(e=>{var i=o(e,{verbose:!cli.config.quietMode,mangle:!cli.config.noMangle,comment:cli.config.comment?.replace(/\\n/g,"\n")});return i.error&&n.push(e),i}).filter(e=>!e.error),cli.config.quietMode||(l?.length?(log.success(cli.msgs.info_minComplete+"!"),log.data(l.length+" "+cli.msgs.info_file+`${1==l.length?"":"s"} ${cli.msgs.info_minified}.`)):console.info(cli.msgs.info_noFilesProcessed+"."),n.length&&(log.error(n.length+" "+cli.msgs.info_file+(1==n.length?"":"s"),cli.msgs.info_failedToMinify+":"),n.forEach(e=>console.info(e)))),l?.length&&(cli.config.copy&&1==l?.length?(log.data(l[0].code),log.ifNotQuiet(`
${cli.msgs.info_copyingToClip}...`),require("node-clipboardy").writeSync(l[0].code)):(log.ifNotQuiet(`
${cli.msgs.info_writing}${1<l?.length?"s":""}...`),l?.forEach(({code:e,srcPath:o,relPath:n})=>{let l,c;if(!cli.config.relativeOutput&&n){let e=g.resolve(process.cwd(),s||"min"),i=g.dirname(n);l="."!=i?g.join(e,i):e,c=`${g.basename(o,".js")}${cli.config.noFilenameChange?"":".min"}.js`}else l=g.join(g.dirname(o),s.endsWith(".js")?g.dirname(s):s||"min"),c=`${s.endsWith(".js")&&r.endsWith(".js")?g.basename(s).replace(/(\.min)?\.js$/,""):g.basename(o,".js")}${cli.config.noFilenameChange?"":".min"}.js`;let i=g.join(l,c);t.mkdirSync(l,{recursive:!0}),t.writeFileSync(i,e,"utf8"),log.ifNotQuiet(`  ${log.colors.bg}✓${log.colors.nc} `+g.relative(process.cwd(),i))})))}};