const e=require("fs"),i=require("child_process")["execSync"],r=require("path"),n="[0m",s="[1;91m",o="[1;92m",t="test/input",c="output/min",l=`node ../minify.js ${t} `+c;console.info(`
> Running '${l}'...`);try{i(l)}catch(e){console.error(`
${s}Error executing command: `+l+n),process.exit(1)}console.info("> Comparing generated files to expected output...");const d=r.resolve(__dirname,"input"),u=r.resolve(__dirname,"expected_output"),f=e.readFileSync(r.resolve(u,c,"file1.min.js"),"utf8"),a=e.readFileSync(r.resolve(u,"nested/dir",c,"file2.min.js"),"utf8"),p=e.readFileSync(r.resolve(d,c,"file1.min.js"),"utf8"),m=e.readFileSync(r.resolve(d,"nested/dir/",c,"file2.min.js"),"utf8");console.info("> Cleaning up generated files/folders..."),e.rmSync(r.resolve(d,c.split("/")[0]),{recursive:!0}),e.rmSync(r.resolve(d,"nested/dir",c.split("/")[0]),{recursive:!0}),p===f&&m===a?console.info(`
${o}Test passed: Minification/recursion succeeded!`+n):(console.error(`
${s}Test failed: Generated files do not match expected output.`+n),process.exit(1));