#!/usr/bin/env node
/**
 *  Â© 2024â€“2025 Adam Lui & contributors under the MIT license.
 *  Source: https://code.generatepw.org
 *  Documentation: https://docs.generatepw.org
 */
const pkgName="generate-pw",copyright="Â© 2024â€“2025 Adam Lui & contributors under the MIT license.",cmdFormat="generate-pw [options|commands]",srcURL="https://code.generatepw.org",docURL="https://docs.generatepw.org/#-command-line-usage",latestLocaleCommitHash="3560750";(async()=>{const e=require(__dirname.match(/src/)?"./generate-pw":"./generate-pw.min")["generatePassword"],o=require("fs"),r=require("path"),{execSync:n,execFileSync:s}=require("child_process"),t="[0m",a="[1;91m",i="[1;97m";let p="en";if("win32"==process.platform)try{p=n("(Get-Culture).TwoLetterISOLanguageName",{shell:"powershell",encoding:"utf-8"}).trim()}catch(e){_("Error loading system language: "+e)}else{var c=process.env;p=(c.LANG||c.LANGUAGE||c.LC_ALL||c.LC_MESSAGES||c.LC_NAME||"en").split(".")[0]}let l={};var m,d,c=new Promise((t,a)=>{const i=`https://cdn.jsdelivr.net/gh/adamlui/js-utils@7cc7fae30f90ea18c05605250bef91a40eb8725c/${pkgName}/_locales/`;var e=(p?p.replace("-","_"):"en")+"/";let c=i+e+"messages.json",l=0;f(c).then(async function s(e){try{const o=await e.json(),r={};for(const n in o)"object"==typeof o[n]&&"message"in o[n]&&(r[n]=o[n].message);t(r)}catch(e){if(3==++l)return t({});f(c=p.includes("-")&&1==l?c.replace(/([^_]*)_[^/]*(\/.*)/,"$1$2"):i+"en/messages.json").then(s).catch(a)}}).catch(a)});try{l=await c}catch(e){_("Error fetching messages: "+e)}const u={},h={paramOptions:{length:/^--?length(?:=.*|$)/,qty:/^--?qu?a?n?ti?t?y(?:=.*|$)/,charset:/^--?charse?t?(?:=.*|$)/,excludeChars:/^--?exclude(?:=.*|$)/},flags:{includeNums:/^--?(?:n|(?:include-?)?num(?:ber)?s?=?(?:true|1)?)$/,includeSymbols:/^--?(?:y|(?:include-?)?symbols?=?(?:true|1)?)$/,excludeLowerChars:/^--?(?:L|(?:exclude|disable|no)-?lower-?(?:case)?|lower-?(?:case)?=(?:false|0))$/,excludeUpperChars:/^--?(?:U|(?:exclude|disable|no)-?upper-?(?:case)?|upper-?(?:case)?=(?:false|0))$/,excludeSimilarChars:/^--?(?:S|(?:exclude|disable|no)-?similar-?(?:char(?:acter)?s?)?|similar-?(?:char(?:acter)?s?)?=(?:false|0))$/,strictMode:/^--?s(?:trict)?(?:-?mode)?$/,quietMode:/^--?q(?:uiet)?(?:-?mode)?$/},infoCmds:{help:/^--?h(?:elp)?$/,version:/^--?ve?r?s?i?o?n?$/}};process.argv.forEach(s=>{var e,o,r;s.startsWith("-")&&(e=Object.keys(h.paramOptions).find(e=>h.paramOptions[e].test(s)),r=Object.keys(h.flags).find(e=>h.flags[e].test(s)),o=Object.keys(h.infoCmds).find(e=>h.infoCmds[e].test(s)),r?u[r]=!0:e?(/=.+/.test(s)||(console.error(`
${a+(l.prefix_error||"ERROR")}: `+`Arg [--${s.replace(/-/g,"")}] `+`${l.error_noEqual||"requires '=' followed by a value"}.${t}`),w(),process.exit(1)),r=s.split("=")[1],u[e]=parseInt(r)||r):o||(console.error(`
${a+(l.prefix_error||"ERROR")}: `+`Arg [${s}] ${l.error_notRecognized||"not recognized"}.[0m`),console.info(`
${"[1;33m"+(l.info_validArgs||"Valid arguments are below")}.[0m`),$(["paramOptions","flags","infoCmds"]),process.exit(1)))});for(const y of["length","qty"])u[y]&&(isNaN(u[y])||u[y]<1)&&(console.error(`
${a+(l.prefix_error||"ERROR")}: [${y}] `+`${l.error_nonPositiveNum||"argument can only be > 0"}.${t}`),w(),process.exit(1));if(process.argv.some(e=>h.infoCmds.help.test(e)))$();else if(process.argv.some(e=>h.infoCmds.version.test(e))){c=n(`npm view ${pkgName} version`).toString().trim()||"none";let e,s=process.cwd();for(;"/"!=s;){var g=r.join(s,"package.json");if(o.existsSync(g)){g=require(g);e=(g.dependencies?.[pkgName]||g.devDependencies?.[pkgName])?.match(/^\d+\.\d+\.\d+$/)?.[0]||"none";break}s=r.dirname(s)}console.info(`
${l.prefix_globalVer||"Global version"}: `+c),console.info(`${l.prefix_localVer||"Local version"}: `+e)}else{c={length:u.length||8,qty:u.qty||1,charset:u.charset,exclude:u.excludeChars,numbers:!!u.includeNums,symbols:!!u.includeSymbols,lowercase:!u.excludeLowerChars,uppercase:!u.excludeUpperChars,excludeSimilarChars:!!u.excludeSimilarChars,strict:!!u.strictMode,verbose:!u.quietMode},c=e(c);_(`
${l.info_copying||"Copying to clipboard"}...`),m=(m=Array.isArray(c)?c.join("\n"):c).replace(/"/g,'""'),d={darwin:{binPath:"/usr/bin/pbcopy",args:[]},linux:{binPath:"/usr/bin/xclip",args:["-selection","clipboard"]},win32:{binPath:r.join(process.env.SYSTEMROOT,"System32","WindowsPowerShell","v1.0","powershell.exe"),args:["-Command","Set-Clipboard -Value $input"]}},s(...Object.values(d[process.platform]),{input:m})}function f(r){return new Promise((o,e)=>{var s=r.match(/^([^:]+):\/\//)[1];/^https?$/.test(s)||e(new Error(`${l.error_invalidURL||"Invalid URL"}.`)),require(s).get(r,e=>{let s="";e.on("data",e=>s+=e),e.on("end",()=>o({json:()=>JSON.parse(s)}))}).on("error",e)})}function $(e=["header","usage","paramOptions","flags","infoCmds"]){var s=`[106m[30m ${pkgName} [0m `;const o={header:["\nâ”œ "+s+(l.appCopyright||copyright),s+(l.prefix_source||"Source")+": "+srcURL],usage:[`
${i}o ${l.helpSection_usage||"Usage"}:[0m`," [1;97mÂ» [1;92m"+cmdFormat+t],paramOptions:[`
${i}o ${l.helpSection_paramOptions||"Parameter options"}:[0m`,` --length=n                  ${l.optionDesc_length||"Generate password(s) of n length"}.`,` --qty=n                     ${l.optionDesc_qty||"Generate n password(s)"}.`,` --charset=chars             ${l.optionDesc_charset||"Only include chars in password(s)"}.`,` --exclude=chars             ${l.optionDesc_exclude||"Exclude chars from password(s)"}.`],flags:[`
${i}o ${l.helpSection_flags||"Boolean options"}:[0m`,` -n, --include-numbers       ${l.optionDesc_includeNums||"Allow numbers in password(s)"}.`,` -y, --include-symbols       ${l.optionDesc_includeSymbols||"Allow symbols in password(s)"}.`,` -L, --no-lowercase          ${l.optionDesc_noLower||"Disallow lowercase letters in password(s)"}.`,` -U, --no-uppercase          ${l.optionDesc_noUpper||"Disallow uppercase letters in password(s)"}.`,` -S, --no-similar            ${l.optionDesc_noSimilar||"Exclude similar characters in password(s)"}.`,` -s, --strict                ${l.optionDesc_strict||"Require at least one character from eachallowed character set in password(s)"}.`,` -q, --quiet                 ${l.optionDesc_quiet||"Suppress all logging except errors"}.`],infoCmds:[`
${i}o ${l.helpSection_infoCmds||"Info commands"}:[0m`," -h, --help                  "+(l.optionDesc_help||"Display help screen."),` -v, --version               ${l.optionDesc_version||"Show version number"}.`]};e.forEach(a=>o[a]?.forEach(e=>{{var r=/header|usage/.test(a)?1:29;const n=process.stdout.columns||80,t=[],s=e.match(/\S+|\s+/g);let o="";s.forEach(e=>{var s=n-(t.length?r:0);o.length+"| ".length+e.length>s&&(t.push(t.length?o.trimStart():o),o=""),o+=e}),t.push(t.length?o.trimStart():o),t.forEach((e,s)=>console.info("| "+(0==s?e:" ".repeat(r)+e)))}})),console.info(`
${l.info_moreHelp||"For more help"}, ${l.info_visit||"visit"}: `+i+docURL+t)}function w(){console.info(`
${l.info_moreHelp||"For more help"}, ${l.info_type||"type"} generate-pw --help' ${l.info_or||"or"} ${l.info_visit||"visit"}
`+i+docURL+t)}function _(e){u.quietMode||console.info(e)}})();