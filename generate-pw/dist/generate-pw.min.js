/**
 *  © 2024–2026 Adam Lui & contributors under the MIT license.
 *  Source: https://github.com/adamlui/js-utils/tree/main/generate-pw/src
 *  Documentation: https://github.com/adamlui/js-utils/tree/main/generate-pw/docs
 */
function generatePassword(s={}){var e={verbose:!0,length:8,qty:1,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(log.prefix="generatePassword()",validateOptions({options:s,defaultOptions:e,helpURL:"https://github.com/adamlui/js-utils/tree/main/generate-pw/docs/#generatepasswordoptions",exampleCall:"generatePassword({ verbose: false, numbers: true })"})){if(1<(s={...e,...s}).qty){let{qty:e,...r}=s;return generatePasswords(e,r)}{var a,e="generatePasswords"==generatePassword.caller?.name;s.verbose&&!e&&log.info("Initializing character set...");let r=s.charset?.toString()||(s.numbers?app.charsets.numbers:"")+(s.symbols?app.charsets.symbols:"")+(s.lowercase?app.charsets.lower:"")+(s.uppercase?app.charsets.upper:""),t=(""==r&&(r=app.charsets.lower+app.charsets.upper),s.exclude&&(s.verbose&&!e&&log.info("Removing excluded characters..."),r=r.replace(new RegExp(`[${s.exclude}]`,"g"),"")),s.excludeSimilarChars&&(s.verbose&&!e&&log.info("Excluding similar characters..."),r=r.replace(/[o0Oil1|]/g,"")),s.verbose&&!e&&log.info("Generating password..."),"");for(let e=0;e<s.length;e++){var o=randomInt(0,r.length);t+=r[o]}return s.strict&&(s.verbose&&!e&&log.info("Enforcing strict mode..."),a=["number","symbol","lower","upper"].filter(e=>s[e+"s"]||s[e+"case"]),t=strictify(t,a)),s.verbose&&!e&&(log.info("Password generated!"),"undefined"!=typeof window)&&log.info("Check returned string."),t}}}function generatePasswords(r,t={}){var e="https://github.com/adamlui/js-utils/tree/main/generate-pw/docs/#generatepasswordsqty-options",s={verbose:!0,length:8,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(log.prefix="generatePasswords()",r=parseInt(r,10),isNaN(r)||r<1)return log.error("1st arg <qty> can only be an integer > 0."),log.helpURL(e);if(validateOptions({options:t,defaultOptions:s,helpURL:e,exampleCall:"generatePasswords(3, { verbose: false, symbols: true })"})){(t={...s,...t}).verbose&&log.info(`Generating password${1<r?"s":""}...`);var a=[];for(let e=0;e<r;e++)a.push(generatePassword(t));return t.verbose&&(log.info(`Password${1<r?"s":""} generated!`),"undefined"!=typeof window)&&log.info("Check returned array."),a}}function strictify(o,n=["number","symbol","lower","upper"],e={}){var r="https://github.com/adamlui/js-utils/tree/main/generate-pw/docs/#strictifypassword-requiredchartypes-options",i={verbose:!0};if(log.prefix="strictify()","string"!=typeof o)return log.error("1st arg <password> must be a string."),log.helpURL(r);var t,s=["number","symbol","lower","upper"];for(t of n=[].concat(n))if(!s.includes(t))return log.error(`2nd arg \`${t}\` is an invalid character type.`),void log.info([`Valid character types: ['${s.join("', '")}']`,"Pass one as a string or more as an array, or all types will be required.","For more help, please visit "+r].join("\n"));if(validateOptions({options:e,defaultOptions:i,helpURL:r,exampleCall:"strictify('pa55word', ['symbol', 'upper'], { verbose: false })"})){e={...i,...e};let r={},t=[];n.forEach(e=>r[e]=!1);for(let e=0;e<o.length;e++)for(var l of n)(app.charsets[l]||app.charsets[l+"s"]).includes(o[e])&&(r[l]=!0,t.push(e));e.verbose&&log.info("Strictifying password...");var p,d=Math.min(o.length,n.length);let s=0,a=o;for(p of n)if(s<d&&!r[p]){let e;for(;e=randomInt(0,o.length),t.includes(e););t.push(e);var g=app.charsets[p]||app.charsets[p+"s"];a=a.substring(0,e)+g[randomInt(0,g.length)]+a.substring(e+1),s++}return e.verbose&&(0<s?(log.info("Password is now strict!"),log.info("Check returned string.")):(log.info(`Password already includes ${n.join(" + ")} characters!`),log.info("No modifications made."))),a}}function validateStrength(r,t={}){var e="https://github.com/adamlui/js-utils/tree/main/generate-pw/docs/#validatestrengthpassword-options",s={minLength:8,minLower:1,minUpper:1,minNumber:1,minSymbol:1},a={verbose:!0};if(log.prefix="validateStrength()","string"!=typeof r)return log.error("1st arg <password> must be a string."),log.helpURL(e);if(validateOptions({options:t,defaultOptions:a,helpURL:e,exampleCall:"validateStrength('pa55word', { verbose: false })"})){(t={...a,...t}).verbose&&log.info("Validating password strength...");var o,n={lower:0,upper:0,number:0,symbol:0};for(o of r)for(var i of Object.keys(n))(app.charsets[i]||app.charsets[i+"s"]).includes(o)&&n[i]++;var l,p,d=[];r.length<s.minLength&&d.push(`Make it at least ${s.minLength} characters long.`);for(l of Object.keys(n))n[l]<s["min"+l[0].toUpperCase()+l.slice(1)]&&d.push(`Include at least one ${l}${["upper","lower"].includes(l)?"case letter":""}.`);let e=0;e+=r.length>=s.minLength?20:0;for(p of Object.keys(n))e+=n[p]>=s["min"+p[0].toUpperCase()+p.slice(1)]?20:0;return t.verbose&&(log.info("Password strength validated!"),log.info("Check returned object for score/recommendations.")),{strengthScore:e,recommendations:d,isGood:80<=e}}}function randomInt(e,r){var t;return"undefined"==typeof require?(t=(window.crypto||window.msCrypto)?.getRandomValues(new Uint32Array(1))[0]/4294967295||Math.random(),Math.floor(t*(r-e))+e):require("crypto").randomInt(e,r)}function validateOptions({options:e,defaultOptions:r,helpURL:t,exampleCall:s}){var a,o,n=Object.keys(r).filter(e=>"boolean"==typeof r[e]),i=Object.keys(r).filter(e=>Number.isInteger(r[e]));if("object"!=typeof e)return a=s.split(",").findIndex(e=>e.trim().startsWith("{"))+1,a+=["st","nd","rd"][a-1]||"th",log.error(`${"0th"==a?"[O":a+" arg [o"}ptions] can only be an object of key/vals.`),log.info("Example valid call:",s),log.validOptions(r),log.helpURL(t),!1;for(o in e){if(!Object.prototype.hasOwnProperty.call(r,o))return log.error(`\`${o}\` is an invalid option.`),log.validOptions(r),log.helpURL(t),!1;if(n.includes(o)&&"boolean"!=typeof e[o])return log.error(`[${o}] option can only be \`true\` or \`false\`.`),log.helpURL(t),!1;if(i.includes(o)&&(e[o]=parseInt(e[o],10),isNaN(e[o])||e[o]<1))return log.error(`[${o}] option can only be an integer > 0.`),log.helpURL(t),!1}return!0}Object.assign(globalThis.app??={},{name:"generate-pw",aliases:{generatePassword:["generate","generatepassword","generatepw","generatePw","generatePW","Generate","Generatepassword","GeneratePassword","Generatepw","GeneratePw","GeneratePW"],generatePasswords:["generatepasswords","generatepws","generatePws","generatePWs","generatePWS","Generatepasswords","GeneratePasswords","Generatepws","GeneratePws","GeneratePWs","GeneratePWS"],strictify:["Strictify"],validateStrength:["validate","Validate","validatestrength","Validatestrength","ValidateStrength"]},charsets:{lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:"!@#$%^&*()-_=+[]{}/\\|;:'\",.<>?"}});let log={prefix:app.name,error(...e){console.error(this.prefix+" » ERROR:",...e)},helpURL(e=app.urls?.docs){this.info("For more help, please visit",e)},info(...e){console.info(this.prefix+" »",...e)},validOptions(e){var r=Object.keys(e).join(", "),e=JSON.stringify(e,void 0,2).replace(/"([^"]+)":/g,"$1:").replace(/"/g,"'").replace(/\n\s*/g," ");this.info(`Valid options: [${r}]`),this.info("If omitted, default settings are: "+e)}};app.exports={generatePassword:generatePassword,generatePasswords:generatePasswords,strictify:strictify,validateStrength:validateStrength};try{module.exports={...app.exports}}catch(e){}try{window.pw={...app.exports}}catch(e){}for(let r in app.aliases){try{app.aliases[r].forEach(e=>module.exports[e]=module.exports[r])}catch(e){}try{app.aliases[r].forEach(e=>window.pw[e]=window.pw[r])}catch(e){}}