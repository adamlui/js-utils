/**
 *  © 2024 Adam Lui & contributors under the MIT license.
 *  Source: https://code.js-utils.com/generate-pw
 *  Documentation: https://docs.js-utils.com/generate-pw
 */
const charsets={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:"!@#$%^&*()-_=+[]{}/\\|;:'\",.<>?"};function generatePassword(t={}){var e={verbose:!0,length:8,qty:1,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(validateOptions(t,e,"https://docs.js-utils.com/generate-pw/#generatepasswordoptions","generatePassword({ verbose: false, numbers: true })")){if(1<(t={...e,...t}).qty){const{qty:r,...s}=t;return generatePasswords(r,s)}{var o,e="generatePasswords"==generatePassword.caller?.name;t.verbose&&!e&&console.info("generatePassword() » Initializing character set...");let r=t.charset?.toString()||(t.numbers?charsets.numbers:"")+(t.symbols?charsets.symbols:"")+(t.lowercase?charsets.lower:"")+(t.uppercase?charsets.upper:""),s=(""==r&&(r=charsets.lower+charsets.upper),t.exclude&&(t.verbose&&!e&&console.info("generatePassword() » Removing excluded characters..."),r=r.replace(new RegExp(`[${t.exclude}]`,"g"),"")),t.excludeSimilarChars&&(t.verbose&&!e&&console.info("generatePassword() » Excluding similar characters..."),r=r.replace(/[o0Oil1|]/g,"")),t.verbose&&!e&&console.info("generatePassword() » Generating password..."),"");for(let e=0;e<t.length;e++){var n=randomInt(0,r.length);s+=r.charAt(n)}return t.strict&&(t.verbose&&!e&&console.info("generatePassword() » Enforcing strict mode..."),o=["number","symbol","lower","upper"].filter(e=>t[e+"s"]||t[e+"case"]),s=strictify(s,o)),t.verbose&&!e&&(console.info("generatePassword() » Password generated!"),"undefined"!=typeof require&&/cli(?:\.min)?\.js$/.test(require.main.filename)||console.info("generatePassword() » Check returned string.")),s}}}function generatePasswords(r,s={}){var e="https://docs.js-utils.com/generate-pw/#generatepasswordsqty-options",t={verbose:!0,length:8,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(r=parseInt(r,10),isNaN(r)||r<1)console.error("generatePasswords() » ERROR: 1st arg <qty> can only be an integer > 0."),console.info("generatePasswords() » For more help, please visit "+e);else if(validateOptions(s,t,e,"generatePasswords(3, { verbose: false, symbols: true })")){(s={...t,...s}).verbose&&console.info(`generatePasswords() » Generating password${1<r?"s":""}...`);var o=[];for(let e=0;e<r;e++)o.push(generatePassword(s));return s.verbose&&console.info(`generatePasswords() » Password${1<r?"s":""} generated!`),"undefined"!=typeof require&&/cli(?:\.min)?\.js$/.test(require.main.filename)||console.info("generatePasswords() » Check returned array."),o}}function strictify(t,o=["number","symbol","lower","upper"],e={}){var r="https://docs.js-utils.com/generate-pw/#strictifypassword-requiredchartypes-options",n={verbose:!0};if("string"!=typeof t)console.error("strictify() » ERROR: 1st arg <password> must be a string."),console.info("strictify() » For more help, please visit "+r);else{var s=["number","symbol","lower","upper"];for(const c of o=Array.isArray(o)?o:[o])if(!s.includes(c))return console.error(`strictify() » ERROR: 2nd arg \`${c}\` is an invalid character type.`),console.info(`strictify() » Valid character types: [ '${s.join("', '")}' ]`),console.info("strictify() » Pass one as a string or more as an array, or all types will be required."),void console.info("strictify() » For more help, please visit "+r);if(validateOptions(e,n,r,"strictify('pa55word', ['symbol', 'upper'], { verbose: false })")){e={...n,...e};const l={},d=[];o.forEach(e=>l[e]=!1);for(let e=0;e<t.length;e++)for(const f of o)(charsets[f]||charsets[f+"s"]).includes(t.charAt(e))&&(l[f]=!0,d.push(e));e.verbose&&console.info("strictify() » Strictifying password...");var a=Math.min(t.length,o.length);let r=0,s=t;for(const p of o)if(r<a&&!l[p]){let e;for(;e=randomInt(0,t.length),d.includes(e););d.push(e);var i=charsets[p]||charsets[p+"s"];s=s.substring(0,e)+i.charAt(randomInt(0,i.length))+s.substring(e+1),r++}return e.verbose&&(0<r?(console.info("strictify() » Password is now strict!"),console.info("strictify() » Check returned string.")):(console.info(`strictify() » Password already includes ${o.join(" + ")} characters!`),console.info("strictify() » No modifications made."))),s}}}function validateStrength(r,s={}){var e="https://docs.js-utils.com/generate-pw/#validatestrengthpassword-options",t={minLength:8,minLower:1,minUpper:1,minNumber:1,minSymbol:1},o={verbose:!0};if("string"!=typeof r)console.error("validateStrength() » ERROR: 1st arg <password> must be a string."),console.info("validateStrength() » For more help, please visit "+e);else if(validateOptions(s,o,e,"validateStrength('pa55word', { verbose: false })")){(s={...o,...s}).verbose&&console.info("validateStrength() » Validating password strength...");var n={lower:0,upper:0,number:0,symbol:0};for(const i of r)for(const c of Object.keys(n))(charsets[c]||charsets[c+"s"]).includes(i)&&n[c]++;var a=[];r.length<t.minLength&&a.push(`Make it at least ${t.minLength} characters long.`);for(const l of Object.keys(n))n[l]<t["min"+l.charAt(0).toUpperCase()+l.slice(1)]&&a.push("Include at least one "+l+`${["upper","lower"].includes(l)?"case letter":""}.`);let e=0;e+=r.length>=t.minLength?20:0;for(const d of Object.keys(n))e+=n[d]>=t["min"+d.charAt(0).toUpperCase()+d.slice(1)]?20:0;return s.verbose&&(console.info("validateStrength() » Password strength validated!"),console.info("validateStrength() » Check returned object for score/recommendations.")),{strengthScore:e,recommendations:a,isGood:80<=e}}}function randomInt(e,r){var s;return"undefined"==typeof require?(s=(window.crypto||window.msCrypto)?.getRandomValues(new Uint32Array(1))[0]/4294967295||Math.random(),Math.floor(s*(r-e))+e):require("crypto").randomInt(e,r)}function validateOptions(e,r,s,t){const o=JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:").replace(/"/g,"'").replace(/\n\s*/g," "),n=Object.keys(r).join(", "),a=Object.keys(r).filter(e=>"boolean"==typeof r[e]),i=Object.keys(r).filter(e=>Number.isInteger(r[e]));let c="validateOptions() » ";try{c=validateOptions.caller?.name+"() » "}catch(e){}var l=t.split(",").findIndex(e=>e.trim().startsWith("{"))+1,d=(l+=["st","nd","rd"][l-1]||"th",()=>{console.info(`${c}Valid options: [ ${n} ]`),console.info(c+"If omitted, default settings are: "+o)}),f=()=>{console.info(c+"For more help, please visit "+s)};if("object"!=typeof e)return console.error(c+`ERROR: ${"0th"==l?"[O":l+" arg [o"}ptions] can only be an object of key/values.`),console.info(c+"Example valid call: "+t),d(),f(),!1;for(const p in e){if(!Object.prototype.hasOwnProperty.call(r,p))return console.error(`${c}ERROR: \`${p}\` is an invalid option.`),d(),f(),!1;if(a.includes(p)&&"boolean"!=typeof e[p])return console.error(`${c}ERROR: [${p}] option can only be \`true\` or \`false\`.`),f(),!1;if(i.includes(p)&&(e[p]=parseInt(e[p],10),isNaN(e[p])||e[p]<1))return console.error(`${c}ERROR: [${p}] option can only be an integer > 0.`),f(),!1}return!0}const apiFunctions={generatePassword:generatePassword,generatePasswords:generatePasswords,strictify:strictify,validateStrength:validateStrength};try{module.exports={...apiFunctions}}catch(e){}try{window.pw={...apiFunctions}}catch(e){}