/**
 *  © 2024–2026 Adam Lui & contributors under the MIT license.
 *  Source: https://code.generatepw.org
 *  Documentation: https://docs.generatepw.org
 */
let charsets={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:"!@#$%^&*()-_=+[]{}/\\|;:'\",.<>?"};function generatePassword(o={}){var e="generatePassword() » ",t={verbose:!0,length:8,qty:1,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(validateOptions(o,t,"https://docs.generatepw.org/#generatepasswordoptions","generatePassword({ verbose: false, numbers: true })")){if(1<(o={...t,...o}).qty){let{qty:e,...r}=o;return generatePasswords(e,r)}{var n,t="generatePasswords"==generatePassword.caller?.name;o.verbose&&!t&&console.info(e+"Initializing character set...");let r=o.charset?.toString()||(o.numbers?charsets.numbers:"")+(o.symbols?charsets.symbols:"")+(o.lowercase?charsets.lower:"")+(o.uppercase?charsets.upper:""),s=(""==r&&(r=charsets.lower+charsets.upper),o.exclude&&(o.verbose&&!t&&console.info(e+"Removing excluded characters..."),r=r.replace(new RegExp(`[${o.exclude}]`,"g"),"")),o.excludeSimilarChars&&(o.verbose&&!t&&console.info(e+"Excluding similar characters..."),r=r.replace(/[o0Oil1|]/g,"")),o.verbose&&!t&&console.info(e+"Generating password..."),"");for(let e=0;e<o.length;e++){var a=randomInt(0,r.length);s+=r[a]}return o.strict&&(o.verbose&&!t&&console.info(e+"Enforcing strict mode..."),n=["number","symbol","lower","upper"].filter(e=>o[e+"s"]||o[e+"case"]),s=strictify(s,n)),o.verbose&&!t&&(console.info(e+"Password generated!"),"undefined"!=typeof window)&&console.info(e+"Check returned string."),s}}}function generatePasswords(r,s={}){var e="https://docs.generatepw.org/#generatepasswordsqty-options",o="generatePasswords() » ",t={verbose:!0,length:8,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(r=parseInt(r,10),isNaN(r)||r<1)console.error(o+"ERROR: 1st arg <qty> can only be an integer > 0."),console.info(o+"For more help, please visit "+e);else if(validateOptions(s,t,e,"generatePasswords(3, { verbose: false, symbols: true })")){(s={...t,...s}).verbose&&console.info(o+`Generating password${1<r?"s":""}...`);var n=[];for(let e=0;e<r;e++)n.push(generatePassword(s));return s.verbose&&(console.info(o+`Password${1<r?"s":""} generated!`),"undefined"!=typeof window)&&console.info(o+"Check returned array."),n}}function strictify(n,a=["number","symbol","lower","upper"],e={}){var r="https://docs.generatepw.org/#strictifypassword-requiredchartypes-options",i={verbose:!0},l="strictify() » ";if("string"!=typeof n)console.error(l+"ERROR: 1st arg <password> must be a string."),console.info(l+"For more help, please visit "+r);else{var s,o=["number","symbol","lower","upper"];for(s of a=Array.isArray(a)?a:[a])if(!o.includes(s))return console.error(l+`ERROR: 2nd arg \`${s}\` is an invalid character type.`),console.info(l+`Valid character types: [ '${o.join("', '")}' ]`),console.info(l+"Pass one as a string or more as an array, or all types will be required."),void console.info(l+"For more help, please visit "+r);if(validateOptions(e,i,r,"strictify('pa55word', ['symbol', 'upper'], { verbose: false })")){e={...i,...e};let r={},s=[];a.forEach(e=>r[e]=!1);for(let e=0;e<n.length;e++)for(var c of a)(charsets[c]||charsets[c+"s"]).includes(n[e])&&(r[c]=!0,s.push(e));e.verbose&&console.info(l+"Strictifying password...");var d,p=Math.min(n.length,a.length);let o=0,t=n;for(d of a)if(o<p&&!r[d]){let e;for(;e=randomInt(0,n.length),s.includes(e););s.push(e);var f=charsets[d]||charsets[d+"s"];t=t.substring(0,e)+f[randomInt(0,f.length)]+t.substring(e+1),o++}return e.verbose&&(0<o?(console.info(l+"Password is now strict!"),console.info(l+"Check returned string.")):(console.info(l+`Password already includes ${a.join(" + ")} characters!`),console.info(l+"No modifications made."))),t}}}function validateStrength(r,s={}){var e="https://docs.generatepw.org/#validatestrengthpassword-options",o={minLength:8,minLower:1,minUpper:1,minNumber:1,minSymbol:1},t={verbose:!0},n="validateStrength() » ";if("string"!=typeof r)console.error(n+"ERROR: 1st arg <password> must be a string."),console.info(n+"For more help, please visit "+e);else if(validateOptions(s,t,e,"validateStrength('pa55word', { verbose: false })")){(s={...t,...s}).verbose&&console.info(n+"Validating password strength...");var a,i={lower:0,upper:0,number:0,symbol:0};for(a of r)for(var l of Object.keys(i))(charsets[l]||charsets[l+"s"]).includes(a)&&i[l]++;var c,d,p=[];r.length<o.minLength&&p.push(`Make it at least ${o.minLength} characters long.`);for(c of Object.keys(i))i[c]<o["min"+c[0].toUpperCase()+c.slice(1)]&&p.push("Include at least one "+c+`${["upper","lower"].includes(c)?"case letter":""}.`);let e=0;e+=r.length>=o.minLength?20:0;for(d of Object.keys(i))e+=i[d]>=o["min"+d[0].toUpperCase()+d.slice(1)]?20:0;return s.verbose&&(console.info(n+"Password strength validated!"),console.info(n+"Check returned object for score/recommendations.")),{strengthScore:e,recommendations:p,isGood:80<=e}}}function randomInt(e,r){var s;return"undefined"==typeof require?(s=(window.crypto||window.msCrypto)?.getRandomValues(new Uint32Array(1))[0]/4294967295||Math.random(),Math.floor(s*(r-e))+e):require("crypto").randomInt(e,r)}function validateOptions(e,r,s,o){let t=JSON.stringify(r,void 0,2).replace(/"([^"]+)":/g,"$1:").replace(/"/g,"'").replace(/\n\s*/g," "),n=Object.keys(r).join(", "),a=Object.keys(r).filter(e=>"boolean"==typeof r[e]),i=Object.keys(r).filter(e=>Number.isInteger(r[e])),l=`${validateOptions.caller?.name||"validateOptions"}() » `;var c,d=o.split(",").findIndex(e=>e.trim().startsWith("{"))+1,p=(d+=["st","nd","rd"][d-1]||"th",()=>{console.info(l+`Valid options: [ ${n} ]`),console.info(l+"If omitted, default settings are: "+t)}),f=()=>{console.info(l+"For more help, please visit "+s)};if("object"!=typeof e)return console.error(l+`ERROR: ${"0th"==d?"[O":d+" arg [o"}ptions] can only be an object of key/values.`),console.info(l+"Example valid call: "+o),p(),f(),!1;for(c in e){if(!Object.prototype.hasOwnProperty.call(r,c))return console.error(l+`ERROR: \`${c}\` is an invalid option.`),p(),f(),!1;if(a.includes(c)&&"boolean"!=typeof e[c])return console.error(l+`ERROR: [${c}] option can only be \`true\` or \`false\`.`),f(),!1;if(i.includes(c)&&(e[c]=parseInt(e[c],10),isNaN(e[c])||e[c]<1))return console.error(l+`ERROR: [${c}] option can only be an integer > 0.`),f(),!1}return!0}let gpwAliases={generatePassword:["generate","generatepassword","generatepw","generatePw","generatePW","Generate","Generatepassword","GeneratePassword","Generatepw","GeneratePw","GeneratePW"],generatePasswords:["generatepasswords","generatepws","generatePws","generatePWs","generatePWS","Generatepasswords","GeneratePasswords","Generatepws","GeneratePws","GeneratePWs","GeneratePWS"],strictify:["Strictify"],validateStrength:["validate","Validate","validatestrength","Validatestrength","ValidateStrength"]},gpwFuncs={generatePassword:generatePassword,generatePasswords:generatePasswords,strictify:strictify,validateStrength:validateStrength};try{module.exports={...gpwFuncs}}catch(e){}try{window.pw={...gpwFuncs}}catch(e){}for(let r in gpwAliases){try{gpwAliases[r].forEach(e=>module.exports[e]=module.exports[r])}catch(e){}try{gpwAliases[r].forEach(e=>window.pw[e]=window.pw[r])}catch(e){}}