/**
 *  © 2024–2025 Adam Lui & contributors under the MIT license.
 *  Source: https://code.generatepw.org
 *  Documentation: https://docs.generatepw.org
 */
const charsets={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:"!@#$%^&*()-_=+[]{}/\\|;:'\",.<>?"};function generatePassword(t={}){var e={verbose:!0,length:8,qty:1,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(validateOptions(t,e,"https://docs.generatepw.org/#generatepasswordoptions","generatePassword({ verbose: false, numbers: true })")){if(1<(t={...e,...t}).qty){const{qty:r,...s}=t;return generatePasswords(r,s)}{var o,e="generatePasswords"==generatePassword.caller?.name;t.verbose&&!e&&console.info("generatePassword() » Initializing character set...");let r=t.charset?.toString()||(t.numbers?charsets.numbers:"")+(t.symbols?charsets.symbols:"")+(t.lowercase?charsets.lower:"")+(t.uppercase?charsets.upper:""),s=(""==r&&(r=charsets.lower+charsets.upper),t.exclude&&(t.verbose&&!e&&console.info("generatePassword() » Removing excluded characters..."),r=r.replace(new RegExp(`[${t.exclude}]`,"g"),"")),t.excludeSimilarChars&&(t.verbose&&!e&&console.info("generatePassword() » Excluding similar characters..."),r=r.replace(/[o0Oil1|]/g,"")),t.verbose&&!e&&console.info("generatePassword() » Generating password..."),"");for(let e=0;e<t.length;e++){var n=randomInt(0,r.length);s+=r[n]}return t.strict&&(t.verbose&&!e&&console.info("generatePassword() » Enforcing strict mode..."),o=["number","symbol","lower","upper"].filter(e=>t[e+"s"]||t[e+"case"]),s=strictify(s,o)),t.verbose&&!e&&(console.info("generatePassword() » Password generated!"),"undefined"!=typeof window)&&console.info("generatePassword() » Check returned string."),s}}}function generatePasswords(r,s={}){var e="https://docs.generatepw.org/#generatepasswordsqty-options",t={verbose:!0,length:8,charset:"",exclude:"",numbers:!1,symbols:!1,lowercase:!0,uppercase:!0,excludeSimilarChars:!1,strict:!1};if(r=parseInt(r,10),isNaN(r)||r<1)console.error("generatePasswords() » ERROR: 1st arg <qty> can only be an integer > 0."),console.info("generatePasswords() » For more help, please visit "+e);else if(validateOptions(s,t,e,"generatePasswords(3, { verbose: false, symbols: true })")){(s={...t,...s}).verbose&&console.info(`generatePasswords() » Generating password${1<r?"s":""}...`);var o=[];for(let e=0;e<r;e++)o.push(generatePassword(s));return s.verbose&&(console.info(`generatePasswords() » Password${1<r?"s":""} generated!`),"undefined"!=typeof window)&&console.info("generatePasswords() » Check returned array."),o}}function strictify(t,o=["number","symbol","lower","upper"],e={}){var r="https://docs.generatepw.org/#strictifypassword-requiredchartypes-options",n={verbose:!0};if("string"!=typeof t)console.error("strictify() » ERROR: 1st arg <password> must be a string."),console.info("strictify() » For more help, please visit "+r);else{var s=["number","symbol","lower","upper"];for(const l of o=Array.isArray(o)?o:[o])if(!s.includes(l))return console.error(`strictify() » ERROR: 2nd arg \`${l}\` is an invalid character type.`),console.info(`strictify() » Valid character types: [ '${s.join("', '")}' ]`),console.info("strictify() » Pass one as a string or more as an array, or all types will be required."),void console.info("strictify() » For more help, please visit "+r);if(validateOptions(e,n,r,"strictify('pa55word', ['symbol', 'upper'], { verbose: false })")){e={...n,...e};const c={},d=[];o.forEach(e=>c[e]=!1);for(let e=0;e<t.length;e++)for(const p of o)(charsets[p]||charsets[p+"s"]).includes(t[e])&&(c[p]=!0,d.push(e));e.verbose&&console.info("strictify() » Strictifying password...");var a=Math.min(t.length,o.length);let r=0,s=t;for(const g of o)if(r<a&&!c[g]){let e;for(;e=randomInt(0,t.length),d.includes(e););d.push(e);var i=charsets[g]||charsets[g+"s"];s=s.substring(0,e)+i[randomInt(0,i.length)]+s.substring(e+1),r++}return e.verbose&&(0<r?(console.info("strictify() » Password is now strict!"),console.info("strictify() » Check returned string.")):(console.info(`strictify() » Password already includes ${o.join(" + ")} characters!`),console.info("strictify() » No modifications made."))),s}}}function validateStrength(r,s={}){var e="https://docs.generatepw.org/#validatestrengthpassword-options",t={minLength:8,minLower:1,minUpper:1,minNumber:1,minSymbol:1},o={verbose:!0};if("string"!=typeof r)console.error("validateStrength() » ERROR: 1st arg <password> must be a string."),console.info("validateStrength() » For more help, please visit "+e);else if(validateOptions(s,o,e,"validateStrength('pa55word', { verbose: false })")){(s={...o,...s}).verbose&&console.info("validateStrength() » Validating password strength...");var n={lower:0,upper:0,number:0,symbol:0};for(const i of r)for(const l of Object.keys(n))(charsets[l]||charsets[l+"s"]).includes(i)&&n[l]++;var a=[];r.length<t.minLength&&a.push(`Make it at least ${t.minLength} characters long.`);for(const c of Object.keys(n))n[c]<t["min"+c[0].toUpperCase()+c.slice(1)]&&a.push("Include at least one "+c+`${["upper","lower"].includes(c)?"case letter":""}.`);let e=0;e+=r.length>=t.minLength?20:0;for(const d of Object.keys(n))e+=n[d]>=t["min"+d[0].toUpperCase()+d.slice(1)]?20:0;return s.verbose&&(console.info("validateStrength() » Password strength validated!"),console.info("validateStrength() » Check returned object for score/recommendations.")),{strengthScore:e,recommendations:a,isGood:80<=e}}}function randomInt(e,r){var s;return"undefined"==typeof require?(s=(window.crypto||window.msCrypto)?.getRandomValues(new Uint32Array(1))[0]/4294967295||Math.random(),Math.floor(s*(r-e))+e):require("crypto").randomInt(e,r)}function validateOptions(e,r,s,t){const o=JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:").replace(/"/g,"'").replace(/\n\s*/g," "),n=Object.keys(r).join(", "),a=Object.keys(r).filter(e=>"boolean"==typeof r[e]),i=Object.keys(r).filter(e=>Number.isInteger(r[e])),l=`${validateOptions.caller?.name||"validateOptions"}() » `;var c=t.split(",").findIndex(e=>e.trim().startsWith("{"))+1,d=(c+=["st","nd","rd"][c-1]||"th",()=>{console.info(l+`Valid options: [ ${n} ]`),console.info(l+"If omitted, default settings are: "+o)}),p=()=>{console.info(l+"For more help, please visit "+s)};if("object"!=typeof e)return console.error(l+`ERROR: ${"0th"==c?"[O":c+" arg [o"}ptions] can only be an object of key/values.`),console.info(l+"Example valid call: "+t),d(),p(),!1;for(const g in e){if(!Object.prototype.hasOwnProperty.call(r,g))return console.error(l+`ERROR: \`${g}\` is an invalid option.`),d(),p(),!1;if(a.includes(g)&&"boolean"!=typeof e[g])return console.error(l+`ERROR: [${g}] option can only be \`true\` or \`false\`.`),p(),!1;if(i.includes(g)&&(e[g]=parseInt(e[g],10),isNaN(e[g])||e[g]<1))return console.error(l+`ERROR: [${g}] option can only be an integer > 0.`),p(),!1}return!0}const gpwAliases={generatePassword:["generate","generatepassword","generatepw","generatePw","generatePW","Generate","Generatepassword","GeneratePassword","Generatepw","GeneratePw","GeneratePW"],generatePasswords:["generatepasswords","generatepws","generatePws","generatePWs","generatePWS","Generatepasswords","GeneratePasswords","Generatepws","GeneratePws","GeneratePWs","GeneratePWS"],strictify:["Strictify"],validateStrength:["validate","Validate","validatestrength","Validatestrength","ValidateStrength"]},gpwFuncs={generatePassword:generatePassword,generatePasswords:generatePasswords,strictify:strictify,validateStrength:validateStrength};try{module.exports={...gpwFuncs}}catch(e){}try{window.pw={...gpwFuncs}}catch(e){}for(const va in gpwAliases){try{gpwAliases[va].forEach(e=>module.exports[e]=module.exports[va])}catch(e){}try{gpwAliases[va].forEach(e=>window.pw[e]=window.pw[va])}catch(e){}}