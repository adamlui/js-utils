/**
 * © 2024–2026 Adam Lui & contributors under the MIT license.
 * Source: https://github.com/adamlui/scss-to-css/tree/main/src
 * Documentation: https://github.com/adamlui/scss-to-css/tree/main/docs
 */
let data=require(`./data${env.devMode?"":".min"}.js`);module.exports={generateRandomLang({includes:e=[],excludes:a=[]}={}){let s=require("fs"),r=require(`./log${env.devMode?"":".min"}.js`),t=require("path"),n=e.length?e:(()=>{var e=t.join(__dirname,"..",".cache"),a=t.join(e,"locales.json");if(s.existsSync(a))try{return JSON.parse(s.readFileSync(a,"utf8"))}catch(e){}var r=t.resolve(process.cwd(),"_locales");return s.existsSync(r)?(r=s.readdirSync(r,{withFileTypes:!0}).filter(e=>e.isDirectory()).map(e=>e.name).filter(e=>/^[a-z]{2}(?:_[A-Z]{2})?$/.test(e)),s.mkdirSync(e,{recursive:!0}),data.atomicWrite(a,JSON.stringify(r,null,2)),r):["en"]})(),l=new Set(a),i="en";return(n=n.filter(e=>!l.has(e))).length&&(i=n[Math.floor(Math.random()*n.length)]),r.debug(`
Random language:  ${i}
`),i},async getMsgs(s="en"){let e=data.flatten(require(`../../${env.devMode?"../_locales/en/":"data/"}messages.json`),{key:"message"});if(!s.startsWith("en")){var t=`${app.urls.jsdelivr}@${app.commitHashes.locales}/_locales/`;let a=t+s.replace("-","_")+"/messages.json",r=0;for(;r<3;)try{e=data.flatten(await(await data.fetch(a)).json(),{key:"message"});break}catch(e){if(2<++r)break;a=s.includes("-")&&1==r?a.replace(/([^_]*)_[^/]*(\/.*)/,"$1$2"):t+"en/messages.json"}}return e},getSysLang(){var e;if("win32"!=process.platform)return((e=process.env).LANG||e.LANGUAGE||e.LC_ALL||e.LC_MESSAGES||e.LC_NAME||"en").split(".")[0];try{return require("child_process").execSync("(Get-Culture).TwoLetterISOLanguageName",{shell:"powershell",encoding:"utf-8"}).trim()}catch(e){return console.error("ERROR loading system language:",e.message),"en"}}};