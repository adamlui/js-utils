#!/usr/bin/env node
/**
 * © 2024–2026 Adam Lui & contributors under the MIT license.
 * Source: https://github.com/adamlui/scss-to-css/tree/main/src
 * Documentation: https://github.com/adamlui/scss-to-css/tree/main/docs
 */
(async()=>{globalThis.env={args:process.argv.slice(2),devMode:/[\\/]src(?:[\\/]|$)/i.test(__dirname)},env.debugMode=env.args.some(e=>/^--?debug(?:-?mode)?$/.test(e));let e=require(`./lib/compile${env.devMode?"":".min"}.js`),s=require(`../scss-to-css${env.devMode?"":".min"}.js`).findSCSS,i=require("fs"),o=require(`./lib/language${env.devMode?"":".min"}.js`),r=require(`./lib/log${env.devMode?"":".min"}.js`),c=require("path"),n=require(`./lib/settings${env.devMode?"":".min"}.js`);Object.assign(globalThis.cli??={},require(`../${env.devMode?"../":"data/"}package-data.json`)),n.load("uiLang"),env.sysLang=cli.config.uiLang||(env.debugMode?o.generateRandomLang({excludes:["en"]}):o.getSysLang()),cli.msgs=await o.getMsgs(env.sysLang),cli.urls.docs+="/#-command-line-usage",env.sysLang.startsWith("en")||(cli.docLocale=env.sysLang.replace("_","-").toLowerCase(),cli.docLocales=await o.getDocLocales(),cli.docLocales.includes(cli.docLocale)&&(cli.urls.docs=cli.urls.docs.replace(/\/[^/]+$/g,`/${cli.docLocale}#readme`)));for(var l of env.args){if(n.controls.init.regex.test(l))return n.initConfigFile();if(n.controls.help.regex.test(l))return r.help();if(n.controls.version.regex.test(l))return r.version()}var[t="",a=""]=env.args.filter(e=>!e.startsWith("-")).map(e=>e.replace(/^\/*/,""));let g=c.resolve(process.cwd(),t);t&&!i.existsSync(g)&&(d=g+".scss",i.existsSync(d)?g=d:(r.error(`${cli.msgs.error_firstArgNotExist}.\n${g} ${cli.msgs.error_doesNotExist}.`),r.success(cli.msgs.info_exampleValidCmd+`: 
» scss-to-css . output.min.css`),r.helpCmdAndDocURL(),process.exit(1))),n.load();var d=/s[ac]ss$/.test(g)&&!i.statSync(g).isDirectory()?[g]:s(g,{recursive:!cli.config.noRecursion,verbose:!cli.config.quietMode,ignores:(cli.config.ignores?.split(",")??[]).map(e=>e.trim())});cli.config.dryRun?d.length?(r.info(cli.msgs.info_scssFilesToBeCompiled+":"),d.forEach(e=>console.info(r.colors.gry,e,r.colors.nc))):r.info(`
${cli.msgs.info_noSCSSfilesWillBeCompiled}.`):e.scss({srcFiles:d,inputPath:g,inputArg:t,outputArg:a})})();