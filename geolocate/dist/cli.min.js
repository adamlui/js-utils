#!/usr/bin/env node
/**
 *  Â© 2024 Adam Lui under the MIT license.
 *  Source: https://code.js-utils.com/geolocate
 *  Documentation: https://docs.js-utils.com/geolocate
 */
const pkgName="@adamlui/geolocate",docURL="https://docs.js-utils.com/geolocate/#-command-line-usage";(async()=>{const e=require(__dirname.match(/src/)?"./geolocate":"./geolocate.min"),s=require("fs"),n=require("path"),i=require("child_process")["execSync"],r="[0m",t="[1;33m",c="[1;97m",l={},a={flags:{quietMode:/^--?q(?:uiet)?(?:-?mode)?$/},infoCmds:{help:/^--?h(?:elp)?$/,version:/^--?ve?r?s?i?o?n?$/}};if(process.argv.forEach(o=>{var e,s;o.startsWith("-")&&(e=Object.keys(a.flags).find(e=>a.flags[e].test(o)),s=Object.keys(a.infoCmds).find(e=>a.infoCmds[e].test(o)),e?l[e]=!0:s||(console.error(`
[1;91mERROR: Arg [${o}] not recognized.[0m`),console.info(`
${t}Valid arguments are below.[0m`),d(["configOptions","infoCmds"]),console.info(`
${t}For more help, type 'minify-js --help' or visit
`+docURL+r),process.exit(1)))}),process.argv.some(e=>a.infoCmds.help.test(e)))d();else if(process.argv.some(e=>a.infoCmds.version.test(e))){var p=i(`npm view ${pkgName} version`).toString().trim()||"none";let e,o=process.cwd();for(;"/"!=o;){var f=n.join(o,"package.json");if(s.existsSync(f)){f=require(f);e=(f.dependencies?.[pkgName]||f.devDependencies?.[pkgName])?.match(/(\d+\.\d+\.\d+)/)[0]||"none";break}o=n.dirname(o)}console.info(`
Global version: `+p),console.info("Local version: "+e)}else{var o,m=[];for(const h of process.argv.slice(2))h.startsWith("-")||(o=h.replace(/[[\]]/g,""),m.push(o));p=await e.locate(m,{verbose:!l.quietMode});p||process.exit(1),l.quietMode||1!=p.length||(console.info(`
IP: `+c+p[0].ip+r),console.info("Country: "+c+p[0].country+r),console.info("Region: "+c+p[0].regionName+r),console.info("City: "+c+p[0].city+r),console.info("Zip: "+c+p[0].zip+r),console.info("Latitude: "+c+p[0].lat+r),console.info("Longitude: "+c+p[0].lon+r),console.info("Time zone: "+c+p[0].timezone.replace(/_/g," ").replace(/\//g," / ")+r),console.info("ISP: "+c+p[0].isp+r)),l.quietMode||console.info("\nCopying to clipboard..."),g=(g=JSON.stringify(p)).replace(/\s+$/,"").replace(/"/g,'""'),"darwin"==process.platform?i(`printf "${g}" | pbcopy`):"linux"==process.platform?i(`printf "${g}" | xclip -selection clipboard`):"win32"==process.platform&&i(`Set-Clipboard -Value "${g}"`,{shell:"powershell"})}var g;function d(e=["usage","configOptions","infoCmds"]){const o={usage:[`
${c}Usage:[0m`," geolocate [ip1] [ip2] [...] [options|commands]"],configOptions:[`
${c}Config options:[0m`," -q, --quiet                 Suppress all logging except errors."],infoCmds:[`
${c}Info commands:[0m`," -h, --help                  Display help screen."," -v, --version               Show version number."]};e.forEach(e=>{o[e]?.forEach(e=>{{const n=process.stdout.columns||80,i=[],o=e.match(/\S+|\s+/g);let s="";o.forEach(e=>{var o=n-(0==i.length?0:29);s.length+e.length>o&&(i.push(0==i.length?s:s.trimStart()),s=""),s+=e}),i.push(0==i.length?s:s.trimStart()),i.forEach((e,o)=>console.info(0==o?e:" ".repeat(29)+e))}})})}})();