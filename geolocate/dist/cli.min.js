#!/usr/bin/env node
/**
 *  Â© 2024 Adam Lui under the MIT license.
 *  Source: https://code.js-utils.com/geolocate
 *  Documentation: https://docs.js-utils.com/geolocate
 */
const pkgName="@adamlui/geolocate",copyright="Â© 2024 Adam Lui under the MIT license.",cmdFormat="geolocate [ip1] [ip2] [...] [options|commands]",srcURL="https://code.js-utils.com/geolocate",docURL="https://docs.js-utils.com/geolocate/#-command-line-usage";(async()=>{const e=require(__dirname.match(/src/)?"./geolocate":"./geolocate.min"),s=require("fs"),n=require("path"),i=require("child_process")["execSync"],r="[0m",t="[1;97m",c={},a={flags:{quietMode:/^--?q(?:uiet)?(?:-?mode)?$/},infoCmds:{help:/^--?h(?:elp)?$/,version:/^--?ve?r?s?i?o?n?$/}};if(process.argv.forEach(o=>{var e,s;o.startsWith("-")&&(e=Object.keys(a.flags).find(e=>a.flags[e].test(o)),s=Object.keys(a.infoCmds).find(e=>a.infoCmds[e].test(o)),e?c[e]=!0:s||(console.error(`
[1;91mERROR: Arg [${o}] not recognized.[0m`),console.info(`
[1;33mValid arguments are below.[0m`),f(["configOptions","infoCmds"]),process.exit(1)))}),process.argv.some(e=>a.infoCmds.help.test(e)))f();else if(process.argv.some(e=>a.infoCmds.version.test(e))){var l=i(`npm view ${pkgName} version`).toString().trim()||"none";let e,o=process.cwd();for(;"/"!=o;){var p=n.join(o,"package.json");if(s.existsSync(p)){p=require(p);e=(p.dependencies?.[pkgName]||p.devDependencies?.[pkgName])?.match(/(\d+\.\d+\.\d+)/)[0]||"none";break}o=n.dirname(o)}console.info(`
Global version: `+l),console.info("Local version: "+e)}else{var o,m=[];for(const d of process.argv.slice(2))d.startsWith("-")||(o=d.replace(/[[\]]/g,""),m.push(o));l=await e.locate(m,{verbose:!c.quietMode});l||process.exit(1),c.quietMode||1!=l.length||(console.info(`
IP: `+t+l[0].ip+r),console.info("Country: "+t+l[0].country+r),console.info("Region: "+t+l[0].regionName+r),console.info("City: "+t+l[0].city+r),console.info("Zip: "+t+l[0].zip+r),console.info("Latitude: "+t+l[0].lat+r),console.info("Longitude: "+t+l[0].lon+r),console.info("Time zone: "+t+l[0].timezone.replace(/_/g," ").replace(/\//g," / ")+r),console.info("ISP: "+t+l[0].isp+r)),c.quietMode||console.info("\nCopying to clipboard..."),g=(g=JSON.stringify(l,null,2)).replace(/"/g,'""'),"darwin"==process.platform?i(`printf "${g}" | pbcopy`):"linux"==process.platform?i(`printf "${g}" | xclip -selection clipboard`):"win32"==process.platform&&i(`Set-Clipboard -Value "${g}"`,{shell:"powershell"})}var g;function f(e=["header","usage","configOptions","infoCmds"]){var o=`[106m[30m ${pkgName.replace(/^@[^/]+\//,"")} [0m `;const s={header:[`
â”œ `+o+copyright,o+"Source: "+srcURL],usage:[`
${t}o Usage:[0m`," [1;97mÂ» [1;92m"+cmdFormat+r],configOptions:[`
${t}o Config options:[0m`," -q, --quiet                 Suppress all logging except errors."],infoCmds:[`
${t}o Info commands:[0m`," -h, --help                  Display help screen."," -v, --version               Show version number."]};e.forEach(t=>{s[t]?.forEach(e=>{{var n=/header|usage/.test(t)?1:29;const i=process.stdout.columns||80,r=[],o=e.match(/\S+|\s+/g);let s="";o.forEach(e=>{var o=i-(0==r.length?0:n);s.length+"| ".length+e.length>o&&(r.push(0==r.length?s:s.trimStart()),s=""),s+=e}),r.push(0==r.length?s:s.trimStart()),r.forEach((e,o)=>console.info("| "+(0==o?e:" ".repeat(n)+e)))}})}),console.info("\nFor more help, please visit: "+t+docURL+r)}})();