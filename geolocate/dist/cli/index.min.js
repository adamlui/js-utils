#!/usr/bin/env node
/**
 *  Â© 2024â€“2026 Adam Lui under the MIT license.
 *  Source: https://github.com/adamlui/js-utils/tree/main/geolocate/src
 *  Documentation: github.com/adamlui/js-utils/tree/main/geolocate/docs
 */
(async()=>{globalThis.env={devMode:__dirname.match(/[\\/]src/)};let e=require("node-clipboardy"),o=require(`../geolocate${env.devMode?"":".min"}.js`),{getMsgs:p,getSysLang:s}=require(`./lib/language${env.devMode?"":".min"}.js`),a=require(`./lib/print${env.devMode?"":".min"}.js`);if(Object.assign(globalThis.app??={},require(`../${env.devMode?"../":"./data/"}app.json`)),app.urls.docs+="/#-command-line-usage",app.msgs=await p(s()),app.colors={nc:"[0m",br:"[1;91m",by:"[1;33m",bg:"[1;92m",bw:"[1;97m",blk:"[30m",tlBG:"[106m"},app.regex={flags:{quietMode:/^--?q(?:uiet)?(?:-?mode)?$/},infoCmds:{help:/^--?h(?:elp)?$/,version:/^--?ve?r?s?i?o?n?$/},version:/^[~^>=]?\d+\.\d+\.\d+$/},app.config={},process.argv.forEach(o=>{var e,p;o.startsWith("-")&&(e=Object.keys(app.regex.flags).find(e=>app.regex.flags[e].test(o)),p=Object.keys(app.regex.infoCmds).find(e=>app.regex.infoCmds[e].test(o)),e?app.config[e]=!0:p||(console.error(`
${app.colors.br}${app.msgs.prefix_error}: Arg [${o}] ${app.msgs.error_notRecognized}.`+app.colors.nc),console.info(`
${app.colors.by}${app.msgs.info_validArgs}.`+app.colors.nc),a.help(["paramOptions","infoCmds"]),process.exit(1)))}),process.argv.some(e=>app.regex.infoCmds.help.test(e)))a.help();else if(process.argv.some(e=>app.regex.infoCmds.version.test(e)))a.version();else{var r,i,c=[];for(r of process.argv.slice(2))r.startsWith("-")||(i=r.replace(/[[\]]/g,""),c.push(i));var n,l=await o.locate(c,{verbose:!app.config.quietMode});l||process.exit(1),app.config.quietMode||1!=l.length||(n=l[0],console.info([`
IP: `+app.colors.bw+n.ip+app.colors.nc,app.msgs.geoLabel_country+": "+app.colors.bw+n.country+app.colors.nc,app.msgs.geoLabel_region+": "+app.colors.bw+n.regionName+app.colors.nc,app.msgs.geoLabel_city+": "+app.colors.bw+n.city+app.colors.nc,app.msgs.geoLabel_zip+": "+app.colors.bw+n.zip+app.colors.nc,app.msgs.geoLabel_lat+": "+app.colors.bw+n.lat+app.colors.nc,app.msgs.geoLabel_lon+": "+app.colors.bw+n.lon+app.colors.nc,app.msgs.geoLabel_timeZone+": "+app.colors.bw+n.timezone.replace(/_/g," ").replace(/\//g," / ")+app.colors.nc,"ISP: "+app.colors.bw+n.isp+app.colors.nc].join("\n"))),a.ifNotQuiet(`
${app.msgs.info_copying}...`),e.writeSync(JSON.stringify(l,void 0,2))}})();