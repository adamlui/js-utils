#!/usr/bin/env node
/**
 *  Â© 2024â€“2026 Adam Lui under the MIT license.
 *  Source: https://code.geolocatejs.org
 *  Documentation: https://docs.geolocatejs.org
 */
(async()=>{globalThis.env={devMode:__dirname.match(/[\\/]src/)};var e=require("node-clipboardy"),s=require("child_process").execSync,p=require("fs"),o=require(`../geolocate${env.devMode?"":".min"}.js`),{getMsgs:n,getSysLang:a}=require(`./lib/language${env.devMode?"":".min"}.js`),i=require("path");globalThis.app=require(`../${env.devMode?"../":"./data/"}app.json`),app.urls.docs+="/#-command-line-usage",app.msgs=await n(a()),app.regex={flags:{quietMode:/^--?q(?:uiet)?(?:-?mode)?$/},infoCmds:{help:/^--?h(?:elp)?$/,version:/^--?ve?r?s?i?o?n?$/},version:/^[~^>=]?\d+\.\d+\.\d+$/};let r={nc:"[0m",br:"[1;91m",by:"[1;33m",bg:"[1;92m",bw:"[1;97m"};if(app.config={},process.argv.forEach(o=>{var e,s;o.startsWith("-")&&(e=Object.keys(app.regex.flags).find(e=>app.regex.flags[e].test(o)),s=Object.keys(app.regex.infoCmds).find(e=>app.regex.infoCmds[e].test(o)),e?app.config[e]=!0:s||(console.error(`
${r.br}${app.msgs.prefix_error}: Arg [${o}] ${app.msgs.error_notRecognized}.`+r.nc),console.info(`
${r.by}${app.msgs.info_validArgs}.`+r.nc),m(["paramOptions","infoCmds"]),process.exit(1)))}),process.argv.some(e=>app.regex.infoCmds.help.test(e)))m();else if(process.argv.some(e=>app.regex.infoCmds.version.test(e))){n=s(`npm view ${JSON.stringify(app.name)} version`).toString().trim()||"none";let e,o=process.cwd();for(;"/"!=o;){var c=i.join(o,"package.json");if(p.existsSync(c)){c=require(c);e=(c.dependencies?.[app.name]||c.devDependencies?.[app.name])?.match(/^[~^>=]?\d+\.\d+\.\d+$/)?.[1]||"none";break}o=i.dirname(o)}console.info(`
${app.msgs.prefix_globalVer}: `+n),console.info(app.msgs.prefix_localVer+": "+e)}else{var g,t,l=[];for(g of process.argv.slice(2))g.startsWith("-")||(t=g.replace(/[[\]]/g,""),l.push(t));a=await o.locate(l,{verbose:!app.config.quietMode});a||process.exit(1),app.config.quietMode||1!=a.length||(console.info(`
IP: `+r.bw+a[0].ip+r.nc),console.info(`${app.msgs.geoLabel_country}: ${r.bw}${a[0].country}${r.nc}}`),console.info(`${app.msgs.geoLabel_region}: ${r.bw}${a[0].regionName}${r.nc}}`),console.info(`${app.msgs.geoLabel_city}: ${r.bw}${a[0].city}${r.nc}}`),console.info(`${app.msgs.geoLabel_zip}: ${r.bw}${a[0].zip}${r.nc}}`),console.info(`${app.msgs.geoLabel_lat}: ${r.bw}${a[0].lat}${r.nc}}`),console.info(`${app.msgs.geoLabel_lon}: ${r.bw}${a[0].lon}${r.nc}}`),console.info(app.msgs.geoLabel_timeZone+": "+r.bw+a[0].timezone.replace(/_/g," ").replace(/\//g," / ")+r.nc),console.info(`ISP: ${r.bw}${a[0].isp}${r.nc}}`)),s=`
${app.msgs.info_copying}...`,app.config.quietMode||console.info(s),e.writeSync(JSON.stringify(a,void 0,2))}function m(e=["header","usage","configOptions","infoCmds"]){app.prefix=`[106m[30m ${app.name.replace(/^@[^/]+\//,"")} ${r.nc} `;let o={header:[`
â”œ ${app.prefix}${app.msgs.appCopyright||`Â© ${app.copyrightYear} ${app.author} under the ${app.license} license`}.`,""+app.prefix+app.msgs.prefix_source+": "+app.urls.src],usage:[`
${r.bw}o ${app.msgs.helpSection_usage}:`+r.nc,` ${r.bw}Â» `+r.bg+app.cmdFormat+r.nc],configOptions:[`
${r.bw}o ${app.msgs.helpSection_configOptions}:`+r.nc,` -q, --quiet                 ${app.msgs.optionDesc_quiet}.`],infoCmds:[`
${r.bw}o ${app.msgs.helpSection_infoCmds}:`+r.nc," -h, --help                  "+app.msgs.optionDesc_help,` -v, --version               ${app.msgs.optionDesc_version}.`]};e.forEach(i=>o[i]?.forEach(o=>{{var a=/header|usage/.test(i)?1:29;let s=process.stdout.columns||80,p=[],e=o.match(/\S+|\s+/g),n="";e.forEach(e=>{var o=s-(p.length?a:0);n.length+"| ".length+e.length>o&&(p.push(p.length?n.trimStart():n),n=""),n+=e}),p.push(p.length?n.trimStart():n),p.forEach((e,o)=>console.info("| "+(0==o?e:" ".repeat(a)+e)))}})),console.info(`
${app.msgs.info_moreHelp}, ${app.msgs.info_visit}: `+r.bw+app.urls.docs+r.nc)}})();