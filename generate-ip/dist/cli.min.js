#!/usr/bin/env node
/**
/**
 *  Â© 2023â€“2026 Adam Lui & contributors under the MIT license.
 *  Source: https://code.minify-js.org/node.js
 *  Documentation: https://docs.minify-js.org/node.js
 */
 *  Â© 2024â€“2026 Adam Lui & contributors under the MIT license.
 *  Source: https://code.generate-ip.org
 *  Documentation: https://docs.generate-ip.org
 */
(async()=>{globalThis.env={sysLang:"en",devMode:__dirname.match(/src/)};var e=require("node-clipboardy"),p=require("child_process").execSync,a=require("fs"),{ipv4:s,ipv6:o,mac:r}=require(`./generate-ip${env.devMode?"":".min"}.js`),n=require("path");globalThis.app=require(`${env.devMode?"..":"."}/app.json`),app.config={},app.urls.docs+="/#-command-line-usage",app.regex={paramOptions:{qty:/^--?qu?a?n?ti?t?y(?:=.*|$)/},flags:{ipv6mode:/^--?(?:ip)?v?6(?:-?mode)?$/,macMode:/^--?m(?:ac)?(?:-?mode)?$/,quietMode:/^--?q(?:uiet)?(?:-?mode)?$/},infoCmds:{help:/^--?h(?:elp)?$/,version:/^--?ve?r?s?i?o?n?$/},version:/^[~^>=]?\d+\.\d+\.\d+$/};let i="[1;91m",t="[1;97m";if("win32"==process.platform)try{env.sysLang=p("(Get-Culture).TwoLetterISOLanguageName",{shell:"powershell",encoding:"utf-8"}).trim()}catch(e){console.error("ERROR loading system language:",e.message)}else{var m=process.env;env.sysLang=(m.LANG||m.LANGUAGE||m.LC_ALL||m.LC_MESSAGES||m.LC_NAME||"en").split(".")[0]}try{var g=require(`${env.devMode?"../_locales/en":"."}/messages.json`);if(env.sysLang.startsWith("en"))app.msgs=f(g);else{var c=`${app.urls.jsdelivr}@${app.commitHashes.locales}/${app.name}/_locales/`;let s=c+`${env.sysLang?env.sysLang.replace("-","_"):"en"}/`+"messages.json",p=0;for(;p<3;)try{app.msgs=f(await(await(a=>new Promise((p,e)=>{var s=a.match(/^([^:]+):\/\//)[1];/^https?$/.test(s)||e(new Error(app.msgs.error_invalidURL+".")),require(s).get(a,e=>{let s="";e.on("data",e=>s+=e),e.on("end",()=>p({json:()=>JSON.parse(s)}))}).on("error",e)}))(s)).json());break}catch(e){if(3==++p){app.msgs=f(g);break}s=env.sysLang.includes("-")&&1==p?s.replace(/([^_]*)_[^/]*(\/.*)/,"$1$2"):c+"en/messages.json"}}}catch(e){app.msgs={},console.error("ERROR loading messages:",e.message)}if(process.argv.forEach(s=>{var e,p,a;s.startsWith("-")&&(e=Object.keys(app.regex.paramOptions).find(e=>app.regex.paramOptions[e].test(s)),a=Object.keys(app.regex.flags).find(e=>app.regex.flags[e].test(s)),p=Object.keys(app.regex.infoCmds).find(e=>app.regex.infoCmds[e].test(s)),a?app.config[a]=!0:e?(/=.+/.test(s)||(console.error(`
${i}${app.msgs.prefix_error}: Arg [--${s.replace(/-/g,"")}] ${app.msgs.error_noEqual}.[0m`),d(),process.exit(1)),a=s.split("=")[1],app.config[e]=parseInt(a)||a):p||/ipv4/.test(s)||(console.error(`
${i}${app.msgs.prefix_error}: Arg [${s}] ${app.msgs.error_notRecognized}.[0m`),console.info(`
[1;33m${app.msgs.info_validArgs}.[0m`),$(["paramOptions","flags","infoCmds"]),process.exit(1)))}),app.config.qty&&(isNaN(app.config.qty)||app.config.qty<1)&&(console.error(`
${i}${app.msgs.prefix_error}: [qty] ${app.msgs.error_nonPositiveNum}.[0m`),d(),process.exit(1)),process.argv.some(e=>app.regex.infoCmds.help.test(e)))$();else if(process.argv.some(e=>app.regex.infoCmds.version.test(e))){m=p(`npm view ${JSON.stringify(app.name)} version`).toString().trim()||"none";let e,s=process.cwd();for(;"/"!=s;){var l=n.join(s,"package.json");if(a.existsSync(l)){l=require(l);e=(l.dependencies?.[app.name]||l.devDependencies?.[app.name])?.match(app.regex.version)?.[1]||"none";break}s=n.dirname(s)}console.info(`
${app.msgs.prefix_globalVer}: `+m),console.info(app.msgs.prefix_localVer+": "+e)}else{p={qty:app.config.qty||1,verbose:!app.config.quietMode},m=(app.config.ipv6mode?o:app.config.macMode?r:s).generate(p);o=`
${app.msgs.info_copying}...`,app.config.quietMode||console.info(o),e.writeSync(Array.isArray(m)?m.join("\n"):m)}function f(e){var s,p={};for(s in e)p[s]="object"==typeof e[s]&&"message"in e[s]?e[s].message:e[s];return p}function d(){console.info(`
${app.msgs.info_moreHelp}, ${app.msgs.info_type||"type"} generate-ip --help' ${app.msgs.info_or} ${app.msgs.info_visit||"visit"}
${t}${app.urls.docs}[0m`)}function $(e=["header","usage","paramOptions","flags","infoCmds"]){app.prefix=`[106m[30m ${app.name} [0m `;let s={header:[`
â”œ `+app.prefix+(app.msgs.appCopyright||`Â© ${app.creationYear}â€“${(new Date).getFullYear()} ${app.author} under the ${app.license} license.`),""+app.prefix+app.msgs.prefix_source+": "+app.urls.src],usage:[`
${t}o ${app.msgs.helpSection_usage}:[0m`,` ${t}Â» [1;92m${app.cmdFormat}[0m`],paramOptions:[`
${t}o ${app.msgs.helpSection_paramOptions}:[0m`,` --qty=n                     ${app.msgs.optionDesc_qty}.`],flags:[`
${t}o ${app.msgs.helpSection_flags}:[0m`,` -6, --ipv6                  ${app.msgs.optionDesc_ipv6}.`,` -m, --mac                   ${app.msgs.optionDesc_mac}.`,` -q, --quiet                 ${app.msgs.optionDesc_quiet}.`],infoCmds:[`
${t}o ${app.msgs.helpSection_infoCmds}:[0m`," -h, --help                  "+app.msgs.optionDesc_help,` -v, --version               ${app.msgs.optionDesc_version}.`]};e.forEach(n=>s[n]?.forEach(s=>{{var r=/header|usage/.test(n)?1:29;let p=process.stdout.columns||80,a=[],e=s.match(/\S+|\s+/g),o="";e.forEach(e=>{var s=p-(a.length?r:0);o.length+"| ".length+e.length>s&&(a.push(a.length?o.trimStart():o),o=""),o+=e}),a.push(a.length?o.trimStart():o),a.forEach((e,s)=>console.info("| "+(0==s?e:" ".repeat(r)+e)))}})),console.info(`
${app.msgs.info_moreHelp}, ${app.msgs.info_visit}: ${t}${app.urls.docs}[0m`)}})();